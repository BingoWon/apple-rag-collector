# Apple RAG Collector - Cloudflare Worker Configuration Template
# Copy this file to wrangler.toml and fill in your own values

name = "your-apple-rag-collector"
main = "src/worker.ts"
compatibility_date = "2024-09-01"
compatibility_flags = ["nodejs_compat"]

[build]
command = "pnpm build"

[observability]
enabled = true
head_sampling_rate = 1

[placement]
mode = "smart"

[triggers]
crons = ["*/6 * * * *"]

# Environment Variables
[vars]
# PostgreSQL Database
DB_HOST = "your-postgres-host"
DB_PORT = "5432"
DB_NAME = "your-database-name"
DB_USER = "your-database-user"
DB_PASSWORD = "your-database-password"
DB_SSL = "true"

# Batch Processing (paid plan: max 1000 requests)
# Total = BATCH_SIZE × BATCH_COUNT = 60 × 15 = 900
BATCH_SIZE = "60"
BATCH_COUNT = "15"
FORCE_UPDATE_ALL = "false"

# Telegram Notifications (optional)
TELEGRAM_STATS_BOT_URL = "https://api.telegram.org/bot{STATS_BOT_TOKEN}/sendMessage?chat_id={CHAT_ID}"
TELEGRAM_ALERT_BOT_URL = "https://api.telegram.org/bot{ALERT_BOT_TOKEN}/sendMessage?chat_id={CHAT_ID}"

# Secrets (add via wrangler CLI, not in this file)
# wrangler secret put DEEPINFRA_API_KEY
